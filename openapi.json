{
  "openapi": "3.1.0",
  "info": {
    "title": "Portainer Stack Webhook",
    "version": "0.2.1"
  },
  "paths": {
    "/api/health": {
      "get": {
        "operationId": "getHealth",
        "summary": "Get Health",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetHealthOutput"
                }
              }
            }
          }
        }
      }
    },
    "/api/stacks": {
      "get": {
        "operationId": "listStacks",
        "summary": "List Stacks",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListStacksOutput"
                }
              }
            }
          }
        }
      }
    },
    "/api/webhook/stacks/{stackId}": {
      "post": {
        "operationId": "updateStackWebhook",
        "summary": "Update Stack Webhook",
        "parameters": [
          {
            "name": "stackId",
            "in": "path",
            "schema": {
              "type": "integer",
              "minimum": 0,
              "maximum": 9007199254740991
            },
            "required": true
          }
        ],
        "responses": {
          "202": {
            "description": "Accepted"
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "number",
            "description": "HTTP status code",
            "example": 400
          },
          "name": {
            "type": "string",
            "description": "The error's name",
            "example": "Bad Request"
          },
          "message": {
            "type": "string",
            "description": "User-facing error message",
            "example": "Property 'name' is required"
          }
        },
        "required": [
          "status",
          "name",
          "message"
        ]
      },
      "GetHealthOutput": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string"
          },
          "uptime": {
            "description": "Uptime in seconds",
            "type": "integer",
            "minimum": 0,
            "maximum": 9007199254740991
          },
          "since": {
            "type": "string",
            "format": "date-time",
            "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))T(?:(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?(?:Z))$"
          },
          "version": {
            "type": "string"
          }
        },
        "required": [
          "status",
          "uptime",
          "since",
          "version"
        ],
        "additionalProperties": false
      },
      "Stack": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "minimum": -9007199254740991,
            "maximum": 9007199254740991
          },
          "name": {
            "type": "string"
          }
        },
        "required": [
          "id",
          "name"
        ],
        "additionalProperties": false
      },
      "ListStacksOutput": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Stack"
        }
      }
    }
  }
}